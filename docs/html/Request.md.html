<meta charset="utf-8">
<style>* { padding: 0; margin: 0; }body { width: 90%; margin: 0 auto; padding: 1em 2em 2em; font-family: "Times New Roman"; border: 1px solid #eee; }h1 { border-bottom: 1px solid #eee; }h1, h2, h3, h4, h5 { padding: 0.4em 0; margin-bottom: 0.5em; }p { border-left: 0.4em #DDDDDD solid; padding: 0.1em 1em 0.5em; background: #FEFFFF; font-size: 0.9em; font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace; }hr { background: #E7E7E7; height: 0.2em; border: 0px; margin: 1em 0; }pre { margin: 1em 0; padding-bottom: 1em; background: #F7F7F7; font-size: 0.9em; font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace; word-wrap: break-word; overflow-x: auto; }code { background: #F5F5F5; padding: 0 0.5em; border: #E0E0E0 1px solid; color: #E21149; font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace; }</style>
<body>
<h1>SPA PHP SDK 请求实例类 Tsa\Request</h1>

Tsa\Request 类存储处理请求信息

<hr>

<h1>Tsa\Request</h1>

<h2>实例介绍</h2>

<h3>Tsa\Request</h3>

<pre><codeblock>
    new Tsa\Request(
        $app,
        $method,
        $url,
        $params,
        $headers,
        $access_token
    )
</codeblock></pre>
<p><code>$app</code>: {App|null} Tsa\App 实例</p><p><code>$method</code>: {string|null} 请求的方式，GET / POST</p><p><code>$url</code>: {string|null} 请求的 URL</p><p><code>$params</code>: {array|array()} 请求参数</p><p><code>$headers</code>: {array|array()} 请求头信息</p><p><code>$access_token</code>: {AccessToken|string|null} access token</p>
<br>
用于收集并处理请求信息

初始化实例：

<pre><codeblock>
    $spaApp = new Tsa\App({$appid}, {$appkey});

    $spa_request = new Tsa\Request($spaApp, 'GET', '/advertiser/read');
</codeblock></pre>

或通过 <code>Tsa\Tsa</code> 类初始化

<pre><codeblock>
    $conf = array(
        'appid'            => '{appid}',
        'appkey'           => '{appkey}',
        'http_client_type' => 'curl',
        'version'          => 'v3'
    );

    $spa = new Tsa\Tsa($conf);

    $spa_request = $spa->request('GET', '/advertiser/read');
</codeblock></pre>

发送请求信息

<pre><codeblock>
    $response = $spa->getClient()->sendRequest($spa_request);
</codeblock></pre>

<hr>

<h2>方法介绍</h2>

<hr>

<h3>setApp()</h3>

<pre><codeblock>
    public Tsa\Request setApp(App $app = null)
</codeblock></pre>

用于设置 <code>Tsa\App</code> 对象，返回 <code>Tsa\Request</code> 对象，可以使用链式操作

<hr>

<h3>getApp()</h3>

<pre><codeblock>
    public Tsa\App getApp()
</codeblock></pre>

获取 <code>Tsa\App</code> 实例

<hr>

<h3>setMethod()</h3>

<pre><codeblock>
    public Tsa\Request setMethod(string $method)
</codeblock></pre>

设置 <code>method</code>，返回 <code>Tsa\Request</code> 对象，可以使用链式操作

<hr>

<h3>getMethod()</h3>

<pre><codeblock>
    public string getMethod()
</codeblock></pre>

返回请求的 <code>method</code>

<hr>

<h3>setUrl()</h3>

<pre><codeblock>
    public Tsa\Request setUrl(string $url)
</codeblock></pre>

设置请求 <code>URL</code>，返回 <code>Tsa\Request</code> 对象，可以使用链式操作

<hr>

<h3>getUrl()</h3>

<pre><codeblock>
    public string getUrl()
</codeblock></pre>

获取请求 <code>URL</code>

获取的同时会对 <code>method</code> 进行验证，对 <code>url</code> 进行处理，返回处理后的 <code>url</code>

验证处理过程中如果出错则会抛出 <code>TsaSDKException</code> 错误

<hr>

<h3>setParams()</h3>

<pre><codeblock>
    public Tsa\Request setParams(array $params)
</codeblock></pre>

设置请求参数，返回 <code>Tsa\Request</code> 对象，可以使用链式操作

<hr>

<h3>getParams()</h3>

<pre><codeblock>
    public array getParams()
</codeblock></pre>

获取请求参数

<hr>

<h3>getPostParams()</h3>

<pre><codeblock>
    public array getPostParams()
</codeblock></pre>

获取 <code>post</code> 请求参数

<hr>

<h3>setHeaders()</h3>

<pre><codeblock>
    public Tsa\Request setHeaders(array $headers)
</codeblock></pre>

设置请求头信息，返回 <code>Tsa\Request</code> 对象，可以使用链式操作

<hr>

<h3>getHeaders()</h3>

<pre><codeblock>
    public array getHeaders()
</codeblock></pre>

获取请求头信息，同时会对 access token 进行验证，若不通过则会抛出 <code>TsaSDKException</code> 错误

<hr>

<h3>setAccessToken()</h3>

<pre><codeblock>
    public Tsa\Request setAccessToken(AccessToken|string $access_token)
</codeblock></pre>

设置 access token，返回 <code>Tsa\Request</code> 对象，可以使用链式操作

<hr>

<h3>getAccessToken()</h3>

<pre><codeblock>
    public AccessToken|string getAccessToken()
</codeblock></pre>

获取 access token

<hr>

<h3>validateAccessToken()</h3>

<pre><codeblock>
    public void validateAccessToken()
</codeblock></pre>

验证实例中的 <code>access token</code>，验证失败则抛出 <code>TsaSDKException</code> 错误

<hr>

<h3>validateMethod()</h3>

<pre><codeblock>
    public void validateMethod()
</codeblock></pre>

验证实例中的 <code>method</code>，验证失败则抛出 <code>TsaSDKException</code> 错误

</body>